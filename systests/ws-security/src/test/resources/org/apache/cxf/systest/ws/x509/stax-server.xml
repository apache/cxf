<?xml version="1.0" encoding="UTF-8"?>
<!--
 Licensed to the Apache Software Foundation (ASF) under one
 or more contributor license agreements. See the NOTICE file
 distributed with this work for additional information
 regarding copyright ownership. The ASF licenses this file
 to you under the Apache License, Version 2.0 (the
 "License"); you may not use this file except in compliance
 with the License. You may obtain a copy of the License at
 
 http://www.apache.org/licenses/LICENSE-2.0
 
 Unless required by applicable law or agreed to in writing,
 software distributed under the License is distributed on an
 "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 KIND, either express or implied. See the License for the
 specific language governing permissions and limitations
 under the License.
-->
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:util="http://www.springframework.org/schema/util"
    xmlns:jaxws="http://cxf.apache.org/jaxws"
    xmlns:http="http://cxf.apache.org/transports/http/configuration"
    xmlns:httpj="http://cxf.apache.org/transports/http-jetty/configuration"
    xmlns:sec="http://cxf.apache.org/configuration/security"
    xmlns:cxf="http://cxf.apache.org/core"
    xmlns:p="http://cxf.apache.org/policy"
    xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-4.2.xsd http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd http://cxf.apache.org/core http://cxf.apache.org/schemas/core.xsd http://cxf.apache.org/policy http://cxf.apache.org/schemas/policy.xsd http://cxf.apache.org/transports/http/configuration http://cxf.apache.org/schemas/configuration/http-conf.xsd http://cxf.apache.org/transports/http-jetty/configuration http://cxf.apache.org/schemas/configuration/http-jetty.xsd http://cxf.apache.org/configuration/security http://cxf.apache.org/schemas/configuration/security.xsd">
    <bean class="org.springframework.context.support.PropertySourcesPlaceholderConfigurer"/>
    <cxf:bus>
        <cxf:features>
            <p:policies/>
            <cxf:logging/>
        </cxf:features>
    </cxf:bus>
    <!-- -->
    <!-- Any services listening on port 9009 must use the following -->
    <!-- Transport Layer Security (TLS) settings -->
    <!-- -->
    <httpj:engine-factory id="tls-settings">
        <httpj:engine port="${testutil.ports.x509.StaxServer.2}">
            <httpj:tlsServerParameters>
                <sec:keyManagers keyPassword="password">
                    <sec:keyStore type="jks" password="password" resource="keys/Bethal.jks"/>
                </sec:keyManagers>
                <sec:clientAuthentication want="true" required="false"/>
            </httpj:tlsServerParameters>
        </httpj:engine>
    </httpj:engine-factory>
    
    <bean id="policyLoader" class="org.apache.cxf.systest.ws.x509.SHA512PolicyLoader" >
          <constructor-arg ref="cxf"/>
    </bean>
    <bean id="doubleItNoSecurity" class="org.apache.cxf.systest.ws.common.DoubleItPortTypeImpl">
        <property name="enforcePrincipal" value="false"/>
    </bean>
    
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="SymmetricErrorMessage" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509SymmetricErrorMessage" serviceName="s:DoubleItService" endpointName="s:DoubleItSymmetricErrorMessagePort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="alice.properties"/>
            <entry key="ws-security.return.security.error" value="true"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="KeyIdentifier" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509KeyIdentifier" serviceName="s:DoubleItService" endpointName="s:DoubleItKeyIdentifierPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.crypto" value-ref="crypto"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="SymmetricAddressing" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509SymmetricAddressing" serviceName="s:DoubleItService" endpointName="s:DoubleItSymmetricAddressingPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.crypto" value-ref="crypto"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="SymmetricAddressingOneWay" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509SymmetricAddressingOneWay" serviceName="s:DoubleItService" endpointName="s:DoubleItSymmetricAddressingOneWayPort" implementor="org.apache.cxf.systest.ws.common.DoubleItOneWayImpl" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.crypto" value-ref="crypto"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="KeyIdentifierDerived" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509KeyIdentifierDerived" serviceName="s:DoubleItService" endpointName="s:DoubleItKeyIdentifierDerivedPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.crypto" value-ref="crypto"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="KeyIdentifierEncryptBeforeSigning" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509KeyIdentifierEncryptBeforeSigning" serviceName="s:DoubleItService" endpointName="s:DoubleItKeyIdentifierEncryptBeforeSigningPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.crypto" value-ref="crypto"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="KeyIdentifierEncryptBeforeSigningDerived" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509KeyIdentifierEncryptBeforeSigningDerived" serviceName="s:DoubleItService" endpointName="s:DoubleItKeyIdentifierEncryptBeforeSigningDerivedPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.crypto" value-ref="crypto"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <bean id="crypto" class="org.apache.wss4j.common.crypto.CryptoFactory" factory-method="getInstance">
        <constructor-arg>
            <util:properties id="cryptoProperties" location="classpath:bob.properties"/>
        </constructor-arg>
    </bean>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="KeyIdentifier2" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509KeyIdentifier2" serviceName="s:DoubleItService" endpointName="s:DoubleItKeyIdentifierPort2" implementor="org.apache.cxf.systest.ws.common.DoubleIt2Impl" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItOperations.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="IssuerSerial" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509IssuerSerial" serviceName="s:DoubleItService" endpointName="s:DoubleItIssuerSerialPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="Thumbprint" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509Thumbprint" serviceName="s:DoubleItService" endpointName="s:DoubleItThumbprintPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="SymmetricThumbprintEndorsing" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509SymmetricThumbprintEndorsing" serviceName="s:DoubleItService" endpointName="s:DoubleItSymmetricThumbprintEndorsingPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="SymmetricEndorsingEncrypted" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509SymmetricEndorsingEncrypted" serviceName="s:DoubleItService" endpointName="s:DoubleItSymmetricEndorsingEncryptedPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="ContentEncryptedElements" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509ContentEncryptedElements" serviceName="s:DoubleItService" endpointName="s:DoubleItContentEncryptedElementsPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="Symmetric256" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509Symmetric256" serviceName="s:DoubleItService" endpointName="s:DoubleItSymmetric256Port" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.enable.streaming" value="true"/>
            <entry key="ws-security.symmetric.signature.algorithm" value="http://www.w3.org/2001/04/xmldsig-more#hmac-sha256"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="Asymmetric" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509Asymmetric" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricIssuerSerialPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.properties" value="alice.properties"/>
            <entry key="security.encryption.username" value="alice"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricOperation" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricOperation" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricIssuerSerialOperationPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.properties" value="alice.properties"/>
            <entry key="security.encryption.username" value="alice"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricSHA512" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricSHA512" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricSHA512Port" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.properties" value="alice.properties"/>
            <entry key="security.encryption.username" value="alice"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricOldConfig" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricOldConfig" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricOldConfigPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="ws-security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="ws-security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.encryption.properties" value="alice.properties"/>
            <entry key="ws-security.encryption.username" value="alice"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricNoInitiatorReference" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricNoInitiatorReference" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricNoInitiatorReferencePort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.properties" value="alice.properties"/>
            <entry key="security.encryption.username" value="alice"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricSP11" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricSP11" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricSP11Port" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.properties" value="alice.properties"/>
            <entry key="security.encryption.username" value="alice"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricEncryptedPassword" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricEncryptedPassword" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricEncryptedPasswordPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob-enc.properties"/>
            <entry key="security.encryption.properties" value="alice-enc.properties"/>
            <entry key="security.encryption.username" value="alice"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricSHA256" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricSHA256" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricSHA256Port" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.properties" value="alice.properties"/>
            <entry key="security.encryption.username" value="alice"/>
            <entry key="ws-security.asymmetric.signature.algorithm" value="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricThumbprint" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricThumbprint" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricThumbprintPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.username" value="useReqSigCert"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricPKIPath" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricPKIPath" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricPKIPathPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.username" value="useReqSigCert"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricEncryptBeforeSigning" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricEncryptBeforeSigning" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricEncryptBeforeSigningPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.username" value="useReqSigCert"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricEncryptBeforeSigningNoEnc" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricEncryptBeforeSigningNoEnc" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricEncryptBeforeSigningNoEncPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.username" value="useReqSigCert"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricEncryptSignature" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricEncryptSignature" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricEncryptSignaturePort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.username" value="useReqSigCert"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricSignature" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricSignature" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricSignaturePort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509Signature.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricSignatureSP11" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricSignatureSP11" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricSignatureSP11Port" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509Signature.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricEncryption" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricEncryption" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricEncryptionPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509Signature.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.properties" value="alice.properties"/>
            <entry key="security.encryption.username" value="alice"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricSignatureEncryption" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricSignatureEncryption" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricSignatureEncryptionPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509Signature.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.username" value="useReqSigCert"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricProtectTokens" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricProtect" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricProtectTokensPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.username" value="useReqSigCert"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricUsernameToken" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricUsernameToken" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricUsernameTokenPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.username" value="useReqSigCert"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricEndorsing" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricEndorsing" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricEndorsingPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.encryption.username" value="useReqSigCert"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="SymmetricUsernameToken" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509SymmetricUsernameToken" serviceName="s:DoubleItService" endpointName="s:DoubleItSymmetricUsernameTokenPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="SymmetricProtectTokens" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509SymmetricProtect" serviceName="s:DoubleItService" endpointName="s:DoubleItSymmetricProtectTokensPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportEndorsing" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportEndorsing" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportEndorsingPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportEndorsingSP11" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportEndorsingSP11" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportEndorsingSP11Port" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportSignedEndorsing" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportSignedEndorsing" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportSignedEndorsingPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportEndorsingEncrypted" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportEndorsingEncrypted" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportEndorsingEncryptedPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportSignedEndorsingEncrypted" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportSignedEndorsingEncrypted" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportSignedEndorsingEncryptedPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportSupportingSigned" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportSupportingSigned" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportSupportingSignedPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportSupportingSignedCertConstraints" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportSupportingSignedCertConstraints" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportSupportingSignedCertConstraintsPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="cxfca.properties"/>
            <entry key="security.subject.cert.constraints" value=".*CN=alice.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportKVT" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportKVT" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportKVTPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.encryption.properties" value="alice.properties"/>
            <entry key="ws-security.is-bsp-compliant" value="false"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportSupportingToken" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportSupportingToken" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportSupportingTokenPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
        <jaxws:features>
            <p:policies>
                <wsp:PolicyReference xmlns:wsp="http://www.w3.org/ns/ws-policy" URI="classpath:/org/apache/cxf/systest/ws/x509/supp-token-policy.xml"/>
            </p:policies>
        </jaxws:features>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportSupportingToken2" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportSupportingToken2" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportSupportingTokenPort2" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
        <jaxws:features>
            <p:policies>
                <wsp:PolicyReference xmlns:wsp="http://www.w3.org/ns/ws-policy" URI="classpath:/org/apache/cxf/systest/ws/x509/supp-token-policy.xml"/>
            </p:policies>
        </jaxws:features>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportPKISupportingToken" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportPKISupportingToken" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportPKISupportingTokenPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
        <jaxws:features>
            <p:policies>
                <wsp:PolicyReference xmlns:wsp="http://www.w3.org/ns/ws-policy" URI="classpath:/org/apache/cxf/systest/ws/x509/supp-token-pki-policy.xml"/>
            </p:policies>
        </jaxws:features>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportEndorsingNegativeTest" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportNegativeEndorsing" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportNegativeEndorsingPort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
        <jaxws:features>
            <p:policies>
                <wsp:PolicyReference xmlns:wsp="http://www.w3.org/ns/ws-policy" URI="classpath:/org/apache/cxf/systest/ws/x509/end-supp-token-policy.xml"/>
            </p:policies>
        </jaxws:features>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="TransportEndorsingNegativeTest2" address="https://localhost:${testutil.ports.x509.StaxServer.2}/DoubleItX509TransportNegativeEndorsing2" serviceName="s:DoubleItService" endpointName="s:DoubleItTransportNegativeEndorsingPort2" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl" depends-on="tls-settings">
        <jaxws:properties>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
        <jaxws:features>
            <p:policies>
                <wsp:PolicyReference xmlns:wsp="http://www.w3.org/ns/ws-policy" URI="classpath:/org/apache/cxf/systest/ws/x509/end-supp-token-policy.xml"/>
            </p:policies>
        </jaxws:features>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="SymmetricSignature" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509SymmetricSignature" serviceName="s:DoubleItService" endpointName="s:DoubleItSymmetricSignaturePort" implementor="#doubleItNoSecurity" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509Signature.wsdl">
        <jaxws:properties>
            <entry key="security.callback-handler" value="org.apache.cxf.systest.ws.common.KeystorePasswordCallback"/>
            <entry key="security.signature.properties" value="bob.properties"/>
            <entry key="security.subject.cert.constraints" value=".*O=apache.org.*"/>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
    <jaxws:endpoint xmlns:s="http://www.example.org/contract/DoubleIt" id="AsymmetricProperties" address="http://localhost:${testutil.ports.x509.StaxServer}/DoubleItX509AsymmetricProperties" serviceName="s:DoubleItService" endpointName="s:DoubleItAsymmetricPropertiesPort" implementor="org.apache.cxf.systest.ws.x509.DoubleItPropertiesImpl" wsdlLocation="org/apache/cxf/systest/ws/x509/DoubleItX509.wsdl">
        <jaxws:properties>
            <entry key="ws-security.enable.streaming" value="true"/>
        </jaxws:properties>
    </jaxws:endpoint>
</beans>